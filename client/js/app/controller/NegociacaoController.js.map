{"version":3,"sources":["../../app-es6/controller/NegociacaoController.js"],"names":["currentInstance","negociacaoController","ListaNegociacoes","Negociacao","Mensagem","Bind","DateHelper","NegociacoesView","MensagemView","NegociacaoService","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importarNegociacoes","event","preventDefault","_criaNegociacao","cadastra","_limpaFormulario","importa","apaga","mensagem","esvazia","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes.js';\nimport {Negociacao} from '../models/Negociacao.js';\nimport {Mensagem} from '../models/Mensagem.js';\nimport {Bind} from '../helpers/Bind.js';\nimport {DateHelper} from '../helpers/DateHelper.js';\nimport {NegociacoesView} from '../views/NegociacoesView.js';\nimport {MensagemView} from '../views/MensagemView.js';\nimport {NegociacaoService} from '../service/NegociacaoService.js';\n\nclass NegociacaoController {\n\n  constructor() {\n    \n    let $ = document.querySelector.bind(document);    \n    this._inputData = $('#data');\n    this._inputQuantidade = $('#quantidade');\n    this._inputValor = $('#valor');\n    this._listaNegociacoes = new Bind(new ListaNegociacoes(), new NegociacoesView($('#negociacoesView')), 'adiciona', 'esvazia');\n    this._mensagem = new Bind(\n      new Mensagem(),\n      new MensagemView($('#mensagemView')),\n      'texto',\n    );\n    this._service = new NegociacaoService();\n    this._init();\n  }\n\n  _init() {\n    this._service\n      .lista()\n      .then(negociacoes =>\n        negociacoes.forEach(negociacao =>\n          this._listaNegociacoes.adiciona(negociacao)\n        )\n      )\n      .catch(erro => this._mensagem.texto = erro);\n\n    setInterval(() => {\n      this.importarNegociacoes()\n    }, 3000)\n  }\n\n  adiciona(event) {\n    event.preventDefault();\n    let negociacao = this._criaNegociacao();\n    this._service\n      .cadastra(negociacao)\n      .then(mensagem => {\n        this._listaNegociacoes.adiciona(negociacao);\n        this._mensagem.texto = \"Negociação adicionada com sucesso\"\n        this._limpaFormulario();        \n      })\n      .catch(erro => this._mensagem.texto = erro);\n  }\n\n  importarNegociacoes() {\n    this._service\n        .importa(this._listaNegociacoes.negociacoes)\n        .then(negociacoes =>           \n          negociacoes.forEach(negociacao => {\n            this._listaNegociacoes.adiciona(negociacao);\n            this._mensagem.texto = 'Negociações do período importadas'   \n        }))\n        .catch(erro => this._mensagem.texto = erro);    \n  }\n\n  apaga() {\n    this._service\n      .apaga()\n      .then(mensagem => {\n        this._mensagem.texto = mensagem;\n        this._listaNegociacoes.esvazia();\n      } )\n      .catch(erro => this._mensagem.texto = erro);\n  }\n\n  _criaNegociacao() {\n    return new Negociacao(\n      DateHelper.textoParaData(this._inputData.value),\n      parseInt(this._inputQuantidade.value),\n      parseFloat(this._inputValor.value)\n    );\n  }\n\n  _limpaFormulario() {\n    this._inputData.value = '';\n    this._inputQuantidade.value = 1;\n    this._inputValor.value = 0.0\n    this._inputData.focus();\n  }\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n  return negociacaoController;\n}\n\n"]}